<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.netfinworks.site.core.dal.daointerface.PosTradeDOMapper" >
  <resultMap id="BaseResultMap" type="com.netfinworks.site.core.dal.dataobject.PosTradeDO" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 09 14:24:07 CST 2016.
    -->
    <result column="TRADE_NO" property="tradeNo" jdbcType="VARCHAR" />
    <result column="MERCHANT_NO" property="merchantNo" jdbcType="VARCHAR" />
    <result column="MERCHANT_NAME" property="merchantName" jdbcType="VARCHAR" />
    <result column="CLIENT_NO" property="clientNo" jdbcType="VARCHAR" />
    <result column="TRADE_S_TIME" property="tradeSTime" jdbcType="VARCHAR" />
    <result column="TRADE_TIME" property="tradeTime" jdbcType="TIMESTAMP" />
    <result column="TRADE_TYPE" property="tradeType" jdbcType="VARCHAR" />
    <result column="BANK_NO" property="bankNo" jdbcType="VARCHAR" />
    <result column="CARD_TYPE" property="cardType" jdbcType="VARCHAR" />
    <result column="BANK" property="bank" jdbcType="VARCHAR" />
    <result column="TRADE_AMOUNT" property="tradeAmount" jdbcType="DECIMAL" />
    <result column="TRADE_FEE" property="tradeFee" jdbcType="DECIMAL" />
    <result column="TRADE_SUM" property="tradeSum" jdbcType="DECIMAL" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="TRADE_SRC_NO" property="tradeSrcNo" jdbcType="VARCHAR" />
    <result column="REASON" property="reason" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="GMT_CREATE" property="gmtCreate" jdbcType="TIMESTAMP" />
    <result column="GMT_UPDATE" property="gmtUpdate" jdbcType="TIMESTAMP" />
    <result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectByTradeNo" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest">
  	select
  	p.*
  	from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_NO = #{tradeNo,jdbcType=VARCHAR}
  </select>
  
  <select id="selectByTradeSrcNo" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest">
  	select
  	p.*
  	from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_SRC_NO = #{tradeSrcNo,jdbcType=VARCHAR}  
  </select>
  
  <select id="selectByTradeTime" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	  select 
  	  *
  	  from
  	   (select
  	    row_number() over(order by p.trade_time desc) rn,p.*
  	    from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	    where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
  	    order by p.TRADE_TIME desc)
  	  where rn between #{page1,jdbcType=INTEGER} and #{page2,jdbcType=INTEGER}
  </select>
  <select id="selectTotalByTradeTime" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	  select
  	    p.*
  	  from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	  where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
  	  order by p.TRADE_TIME desc
  </select>
  
  <select id="selectByTradeType" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
      select 
  	  *
  	  from
  	  (select
  	   row_number() over(order by p.trade_time desc) rn,p.*
  	   from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	   where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_TYPE = #{tradeType,jdbcType=VARCHAR} and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
       order by p.TRADE_TIME desc
       )
       where rn between #{page1,jdbcType=INTEGER} and #{page2,jdbcType=INTEGER}
  </select>
  <select id="selectTotalByTradeType" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	select
  	p.*
  	from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_TYPE = #{tradeType,jdbcType=VARCHAR} and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
  	order by p.TRADE_TIME desc
  </select>
  
  <select id="selectTotalByTradeStatus" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	select
  	p.*
  	from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	where m.MERCHANT_NO = p.MERCHANT_NO and p.STATUS = #{status,jdbcType=VARCHAR} and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
  	order by p.TRADE_TIME desc
  </select>
  <select id="selectByTradeStatus" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	select 
  	  *
  	  from
  	  (select
  	  row_number() over(order by p.trade_time desc) rn,p.*
  	  from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	  where m.MERCHANT_NO = p.MERCHANT_NO and p.STATUS = #{status,jdbcType=VARCHAR} and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
      order by p.TRADE_TIME desc
      )
      where rn between #{page1,jdbcType=INTEGER} and #{page2,jdbcType=INTEGER}
  </select>
  
  <select id="selectByTradeAll" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	  select 
  	  *
  	  from
  	  (select
  	    row_number() over(order by p.trade_time desc) rn,p.*
  	    from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	    where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_TYPE = #{tradeType,jdbcType=VARCHAR} and p.STATUS = #{status,jdbcType=VARCHAR} and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
       	order by p.TRADE_TIME desc
       )
       where rn between #{page1,jdbcType=INTEGER} and #{page2,jdbcType=INTEGER}
  </select>
  <select id="selectTotalByTradeAll" resultMap="BaseResultMap" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest" >
  	select
  	p.*
  	from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	where m.MERCHANT_NO = p.MERCHANT_NO and p.TRADE_TYPE = #{tradeType,jdbcType=VARCHAR} and p.STATUS = #{status,jdbcType=VARCHAR} and p.TRADE_TIME between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
  	order by p.TRADE_TIME desc
  </select>
  
  <select id="selectTradeType" resultType="java.lang.String" parameterType="com.netfinworks.site.core.dal.dataobject.PosRequest">
  	select
  	distinct(p.TRADE_TYPE)
  	from T_POS_TRADE p,(select * from T_MERCHNO_MAP_MEMBID where MEMBER_ID = #{memberNo,jdbcType=VARCHAR}) m
  	where m.MERCHANT_NO = p.MERCHANT_NO
  </select>
  
  <insert id="insert" parameterType="com.netfinworks.site.core.dal.dataobject.PosTradeDO" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 09 14:24:07 CST 2016.
    -->
    insert into T_POS_TRADE (TRADE_NO, MERCHANT_NO, MERCHANT_NAME, 
      CLIENT_NO, TRADE_S_TIME, TRADE_TIME, 
      TRADE_TYPE, BANK_NO, CARD_TYPE, 
      BANK, TRADE_AMOUNT, TRADE_FEE, 
      TRADE_SUM, STATUS, TRADE_SRC_NO, 
      REASON, REMARK, GMT_CREATE, 
      GMT_UPDATE, OPERATOR)
    values (#{tradeNo,jdbcType=VARCHAR}, #{merchantNo,jdbcType=VARCHAR}, #{merchantName,jdbcType=VARCHAR}, 
      #{clientNo,jdbcType=VARCHAR}, #{tradeSTime,jdbcType=VARCHAR}, #{tradeTime,jdbcType=TIMESTAMP}, 
      #{tradeType,jdbcType=VARCHAR}, #{bankNo,jdbcType=VARCHAR}, #{cardType,jdbcType=VARCHAR}, 
      #{bank,jdbcType=VARCHAR}, #{tradeAmount,jdbcType=DECIMAL}, #{tradeFee,jdbcType=DECIMAL}, 
      #{tradeSum,jdbcType=DECIMAL}, #{status,jdbcType=VARCHAR}, #{tradeSrcNo,jdbcType=VARCHAR}, 
      #{reason,jdbcType=VARCHAR}, #{remark,jdbcType=VARCHAR}, #{gmtCreate,jdbcType=TIMESTAMP}, 
      #{gmtUpdate,jdbcType=TIMESTAMP}, #{operator,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.netfinworks.site.core.dal.dataobject.PosTradeDO" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 09 14:24:07 CST 2016.
    -->
    insert into T_POS_TRADE
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="tradeNo != null" >
        TRADE_NO,
      </if>
      <if test="merchantNo != null" >
        MERCHANT_NO,
      </if>
      <if test="merchantName != null" >
        MERCHANT_NAME,
      </if>
      <if test="clientNo != null" >
        CLIENT_NO,
      </if>
      <if test="tradeSTime != null" >
        TRADE_S_TIME,
      </if>
      <if test="tradeTime != null" >
        TRADE_TIME,
      </if>
      <if test="tradeType != null" >
        TRADE_TYPE,
      </if>
      <if test="bankNo != null" >
        BANK_NO,
      </if>
      <if test="cardType != null" >
        CARD_TYPE,
      </if>
      <if test="bank != null" >
        BANK,
      </if>
      <if test="tradeAmount != null" >
        TRADE_AMOUNT,
      </if>
      <if test="tradeFee != null" >
        TRADE_FEE,
      </if>
      <if test="tradeSum != null" >
        TRADE_SUM,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="tradeSrcNo != null" >
        TRADE_SRC_NO,
      </if>
      <if test="reason != null" >
        REASON,
      </if>
      <if test="remark != null" >
        REMARK,
      </if>
      <if test="gmtCreate != null" >
        GMT_CREATE,
      </if>
      <if test="gmtUpdate != null" >
        GMT_UPDATE,
      </if>
      <if test="operator != null" >
        OPERATOR,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="tradeNo != null" >
        #{tradeNo,jdbcType=VARCHAR},
      </if>
      <if test="merchantNo != null" >
        #{merchantNo,jdbcType=VARCHAR},
      </if>
      <if test="merchantName != null" >
        #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="clientNo != null" >
        #{clientNo,jdbcType=VARCHAR},
      </if>
      <if test="tradeSTime != null" >
        #{tradeSTime,jdbcType=VARCHAR},
      </if>
      <if test="tradeTime != null" >
        #{tradeTime,jdbcType=TIMESTAMP},
      </if>
      <if test="tradeType != null" >
        #{tradeType,jdbcType=VARCHAR},
      </if>
      <if test="bankNo != null" >
        #{bankNo,jdbcType=VARCHAR},
      </if>
      <if test="cardType != null" >
        #{cardType,jdbcType=VARCHAR},
      </if>
      <if test="bank != null" >
        #{bank,jdbcType=VARCHAR},
      </if>
      <if test="tradeAmount != null" >
        #{tradeAmount,jdbcType=DECIMAL},
      </if>
      <if test="tradeFee != null" >
        #{tradeFee,jdbcType=DECIMAL},
      </if>
      <if test="tradeSum != null" >
        #{tradeSum,jdbcType=DECIMAL},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="tradeSrcNo != null" >
        #{tradeSrcNo,jdbcType=VARCHAR},
      </if>
      <if test="reason != null" >
        #{reason,jdbcType=VARCHAR},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="gmtCreate != null" >
        #{gmtCreate,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtUpdate != null" >
        #{gmtUpdate,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null" >
        #{operator,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
</mapper>